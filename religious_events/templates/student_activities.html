{% extends 'base.html' %}

{% block title %}활동 내역 - 종교행사 관리 시스템{% endblock %}

{% block content %}
    <h1>활동 내역</h1>
    <h2>예약된 행사</h2>
    <a href="{% url 'student_profile' %}">내 프로필</a>
    <table>
        <thead>
            <tr>
                <th>날짜</th>
                <th>행사 이름</th>
                <th>종교</th>
                <th>상태</th>
                <th>예약 취소</th>
            </tr>
        </thead>
        <tbody>
            {% for event in reserved_events %}
                <tr>
                    <td>{{ event.date }}</td>
                    <td>{{ event.event_id }}</td>
                    <td>{{ event.get_religion_display }}</td>
                    <td>{{ event.get_status_display }}</td>
                    <td>
                        <form method="post" action="{% url 'student_reservation' %}">
                            {% csrf_token %}
                            <input type="hidden" name="event_id" value="{{ event.event_id }}">
                            <input type="hidden" name="action" value="cancel">
                            <button type="submit">예약 취소</button>
                        </form>
                    </td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="5">예약된 행사가 없습니다.</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <h2>예약 가능한 행사</h2>
    <table>
        <thead>
            <tr>
                <th>날짜</th>
                <th>행사 이름</th>
                <th>종교</th>
                <th>상태</th>
                <th>예약</th>
            </tr>
        </thead>
        <tbody>
            {% for event in events %}
                {% if event not in reserved_events %}
                    <tr>
                        <td>{{ event.date }}</td>
                        <td>{{ event.event_id }}</td>
                        <td>{{ event.get_religion_display }}</td>
                        <td>{{ event.get_status_display }}</td>
                        <td>
                            <form method="post" action="{% url 'student_reservation' %}">
                                {% csrf_token %}
                                <input type="hidden" name="event_id" value="{{ event.event_id }}">
                                <input type="hidden" name="action" value="reserve">
                                <button type="submit">예약</button>
                            </form>
                        </td>
                    </tr>
                {% endif %}
            {% empty %}
                <tr>
                    <td colspan="5">예약 가능한 행사가 없습니다.</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}